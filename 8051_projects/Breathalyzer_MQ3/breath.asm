
MOV R1,#38H
ACALL COMMAND
MOV R1,#0EH
ACALL COMMAND
MOV R1,#06H
ACALL COMMAND
MOV R1,#01H
ACALL COMMAND
	START:
	CLR P3.5
	NOP
	SETB P3.5
		WAIT:
		JB P3.2,WAIT
	ACALL READ
	ACALL CONVERSION
	ACALL DATA2
	ACALL DATA1
	ACALL EPR
	ACALL DELAY 
	MOV R1,#01H
	ACALL COMMAND
	ACALL DELAY
	LJMP START
		READ: 
		CLR P3.4
		MOV A,P2
		MOV 30H,A
		SETB P3.4
		RET
		DELAY:
		MOV R1,#225
		L2: MOV R0,#225
		L1: DJNZ R0,L1
		DJNZ R1,L2
		RET
		COMMAND:
		CLR P1.2
		MOV P0,R1
		SETB P1.0
		ACALL DELAY
		CLR P1.0
		RET
		DATA2: 
		SETB P1.2
		MOV P0,R4
		SETB P1.0
		ACALL DELAY
		CLR P1.0
		RET
		DATA1:
		SETB P1.2
		MOV P0,R3
		SETB P1.0
		ACALL DELAY
		CLR P1.0
		RET
		EPR:
		SETB P1.2
		MOV P0,R2
		SETB P1.0
		ACALL DELAY
		CLR P1.0
		RET
		CONVERSION:
		MOV B,#10
		DIV AB
		MOV R2,B
		MOV B,#10
		DIV AB
		ORL A,#30H
		MOV R4,A
		MOV A,B
		ORL A,#30H
		MOV R3,A
		MOV A,R2
		ORL A,#30H
		MOV R2,A
		RET 
		END
		
		